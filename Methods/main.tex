\documentclass{article}
\usepackage{../header}
\title{Methods}
\author{Notes made by Finley Cooper}
\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage
\section{Fourier Series}
\subsection{Motivation}
In 1807 J. Fourier was studying head conduction along a metal rod. This lead him to study $ 2\pi $-periodic functions i.e. functions $ f:\R\to \R $ was such that $ f(\theta+2\pi)=f(\theta) $ for all $ \theta\in \R $ then he found that if \[
	f(\theta)=\sum_{n\in\Z}\hat{f_n}e^{in\theta}
\]
then you can write down the coefficients $ \{\hat{f_n}\} $ via the formula
\[
	\hat{f_n}=\frac 1{2\pi}\int_{0}^{2\pi}f(\theta)e^{-in\theta}\mathrm d\theta,\quad n\in \Z.
\]
And Fourier believed that this worked for any $ 2\pi $-periodic function $ f $. So computing each $ \{\hat{f}_n\} $ and construcuted the sum as above, then it would return the original function. He was wrong.
\subsection{Modern Treatment}
Introduce a vector space $ V $ of $ L $-periodic functions. Hence
\[
	V=\{f:\R\to\C:\text{ with } f \text{ a "nice" function},\text { } f(\theta+L)=f(\theta), \forall \theta\in\R\}.
\]
Note for $ f\in V $ need only to consider values of $ f $ taken in an interval of length $ L $, i.e. $ [0,L) $ or $ (-\frac L2,\frac L2] $ since periodicity covers elsewhere.\par
We can introduce an inner product on $ V $ with
\[
	\langle f,g\rangle=\int_0^1f(\theta)\overline{g(\theta)}\mathrm d\theta.
\]
This gives the associated norm,
\[
	||f||=\sqrt{\langle f,f\rangle}.
\]
For $ n\in \Z $ consider $ e_n\in V $ defined by $ e_n(\theta)=e^{2\pi i n\theta / L }$.
\[
\langle e_n,e_m\rangle = \int_0^L e^{2\pi i (n-m)\theta / L}\,\mathrm d\theta = L\,\delta_{nm}.
\]
So $ \{e_n\} $ are orthogonal and $ ||e_n||^2=L $ for each $ n\in \Z $. This looks like IA Vectors and Matrices.\par
Recall that if $ v_N $ is $ N $-dim vector space equipped with usual inner product and $ \{ e_n\}^N_{n=1} $ are orthogonal with $ | e_n|=L $, then for each $  x\in V $ we can write $  x = \sum_{n=1}^N \hat{x}_n{e_n} $ for some $ \{\hat {x}_n\} $. To find $ \{\hat{x}_n\} $ take the inner product of both sides with $  e_m $. So
\[
	( x,  e_m)=\sum_{n=1}^N \hat{x}_n( e_n\cdot  e_m)=L\hat{x}_m
\]
i.e
\[
\hat x_n = \frac 1L( x\cdot  e_n).
\]
Now could this work on $ V $? $ V $ is not finite dimensional so it's not obvious. Every subset of $ \{e_n\} $ is linearly indepedent. Ignoring this for now we assume that for all $ f\in V $ we can write $ f $ in our basis $ \{e_n\} $. Then
\[
  f(\theta)=\sum_n\hat f_ne_n(\theta),
\]
So taking the inner product as before
\[
  \langle f,e_m\rangle = \sum_n\hat f_n\langle e_n,e_m\rangle
\]
so using the delta as before
\[
  =L\hat f_m
\]
i.e.
\[
	\hat f_n=\frac{1}{L}\langle f, e_n\rangle = \frac{1}{L} \int_0^1 f(\theta)e^{-2\pi in\theta/L}\mathrm d\theta
\]
\begin{definition}
	(Complex Fourier series) For an $ L $-periodic $ f:\R\to \C $ define its \textit{complex Fourier series} by
	\[
		\sum_n\hat f_n e^{2\pi in \theta /L}
	\]
	where
	\[
		\hat f_n = \frac 1L \int_0^1 f(\theta) e^{-2\pi in\theta/L}\mathrm d \theta
	\]
	are called the complex Fourier coefficients. We will write for $ f\in V $
	\[
		f(\theta)\sim \sum_n\hat f_n e^{2\pi in\theta/L}
	\]
	to mean the series on the right corresponds to complex Fourier series for the function on the left.
\end{definition}
We'd like to replace the $ \sim $ symbol with equality, but we require a bit more than that.\par
If we split the complex Fourier series into the parts $\{n=0\}\cup\{n>0\}\cup\{n<0\}$ we get
\[
\sum_n\hat f_n e^{2\pi i n\theta / L} = \hat f_0 + \sum_{n=1}^\infty \hat f_n\left[\cos\left(\frac{2\pi n\theta}{L}\right)+i\sin\left(\frac{2\pi n\theta}{L}\right)\right]
+
\sum_{n=1}^\infty \hat f_{-n}\left[\cos\left(\frac{2\pi n\theta}{L}\right)-i\sin\left(\frac{2\pi n\theta}{L}\right)\right].
\]

\begin{definition}
	(Fourier series) For $ f: \R\to \C $ an $ L $-periodic function define its \textit{Fourier series} by
	\[
		\frac 1L a_0+\sum_{n=1}^\infty\left[a_n\cos\left(\frac{2\pi n\theta}L\right)+b_n\sin\left(\frac{2\pi n\theta}L\right)\right]
	\]
	where
	\[
		a_n=\frac 2L\int^L_0f(\theta)\cos\left(\frac{2\pi n\theta}L\right)\mathrm d\theta
	\]
	and
	\[
		b_n=\frac 2L\int^L_0f(\theta)\sin\left(\frac{2\pi n\theta}L\right)\mathrm d\theta
	\]
	are called the Fourier cofficients for $ f $.
\end{definition}
If we set
\begin{align*}
c_n(\theta) &= \cos\left(\frac{2\pi n\theta}{L}\right),\\
s_n(\theta) &= \sin\left(\frac{2\pi n\theta}{L}\right),
\end{align*}
then we can show, for $ m,n\ge 1 $ that $ \langle c_n,c_m\rangle=\langle s_n, s_m\rangle =\frac L2 \delta_{mn} $ and
\[
  \langle c_n,1\rangle = \langle s_m,1\rangle = \langle c_n, s_m \rangle = 0.
\]
So we have that $ \{1,c_n,c_n\} $ is orthogonal set in $ V $.\par
For an example take $ f:\R\to \R $, $1$-periodic, such that $ f(\theta)=\theta(1-\theta)$ on $[0,1)$. For $n\neq 0$ we have
\[
\hat f_n = \int_0^1 \theta(1-\theta)e^{-2\pi i n\theta}\,\mathrm d\theta.
\]
Integrating by parts (or using a standard Fourier integral computation) yields
\[
\hat f_n = -\frac{1}{2(\pi n)^2},\qquad n\neq 0,
\]
and
\[
\hat f_0 = \int_0^1 (\theta-\theta^2)\,\mathrm d\theta = \frac{1}{6}.
\]
Hence
\[
f(\theta) \sim \frac{1}{6} - \sum_{n\neq 0}\frac{e^{2\pi i n\theta}}{2(\pi n)^2}.
\]
so the sine terms cancel in the sum giving just cosine terms as we expect since our $ f $ function is even.
\subsection{Convergence of Fourier series}
This subject is extremely subtle.

\begin{definition}
	For $ f:\R\to \C $ an $ L $-periodic function we defined the \textit{partial Fourier series} as
	\begin{align*}
		(S_Nf)(\theta)&=\sum_{|n|<N}\hat f_ne^{2\pi in\theta /L} \\
			      &= \frac 12a_0+\sum_{n=1}^N\left[a_n\cos\left(\frac {2\pi n\theta}L\right)+b_n\sin\left(\frac{2\pi n\theta}L\right)\right]
	\end{align*}
\end{definition}
Natural to ask if $ (S_Nf)\to f $. For this we need to specify what type of functional convergence we're looking at. Pointwise? Uniform? Maybe they converge in the idea of our new norm?
\[
	||S_Nf-f||=\sqrt{\int_0^L|(S_Nf)(\theta)-f(\theta)|^2\mathrm d\theta}\to 0
\].
For simplicity, we will only consider pointwise convergence.
\begin{proposition}
  Let $ f:\R\to\C $ be an $ L $-periodic function for which on $ [0,L) $ we have the following,
  \begin{enumerate}
	  \item $ f $ has finitely many discontinuities.
	  \item $ f $ has finitely many local maxima and minima.
  \end{enumerate}
  Then for each $ \theta\in[0,1) $ we have
  \begin{align*}
	  \frac{\theta_++\theta_-}2 &= \lim_{n\to \infty}(S_Nf)(\theta)\\
				    &= \sum_n\hat f_n e^{2\pi in\theta/L}
  \end{align*}
where $ f(\theta_\pm) = \lim_{\varepsilon\to 0^+}f(\theta \pm \varepsilon) $. So at the points of continuity the Fourier series gives back the original function, and at points of discontunity the Fourier series gives back the average of the function at the disconunity neighbourhood.
\end{proposition}
We call functions which properties (i) and (ii) Dirichlet functions. For now on assume all functions are Dirichlet functions so that $ \sim $ means that the series on the RHS coincides with the function on the LHS at points of continuity and to the average at points of discontinuity.\par
\pf We'll prove the proposition only for functions in $ C^\infty(\R) $ (actually $ C^1(\R) $ will do.\\
Assume \textit{wlog} that $ L=2\pi $. Examine $ \lim S_Nf(\theta_0) $ for some $ \theta_0\in[0,2\pi) $. By replacing $ f(\theta) $ with $ f(\theta+\theta_0) $ can assume that $ \theta_0=0 $ \textit{wlog}.
\begin{align*}
	(S_Nf)(\theta)&=\sum_{|n|\le N}\hat f_ne^{in\cdot \theta} \\
		      &= \sum_{|n|\le N}\left(\frac{1}{2\pi}\int_{-\pi}^\pi f(\theta)e^{-in\theta}\mathrm d\theta\right)\\
		 &= \frac{1}{2\pi}\int_{-\pi}^\pi f(\theta)\left[\sum_{|n|\le N}e^{-in\theta}\right]\mathrm d\theta
\end{align*}
We can sum the series as a geometric series, so
\begin{align*}
	e^{-iN\theta}\sum_{n=0}^{2N}e^{-in\theta}=\frac{\sin[(N+\frac 12)\theta]}{\sin(\frac{\theta}{2})}
\end{align*}
when $ \theta\in \R\setminus2\pi\Z $ and the sum is $ 2N+1 $ when $ \theta\in2\pi\Z $.\\
Define the \textit{Dirichlet Kernal} as
\[
  D_N(\theta)=\begin{cases}
	  \frac{\sin[(N+\frac 12)\theta]}{\sin(\frac\theta 2)} & \theta\in \R\setminus 2\pi \Z \\
	  2N+1 & \text{otherwise}
  \end{cases}
\]
For each $ N\ge 0 $,
\begin{enumerate}
	\item $ D_N $ is continiuous, even $ 2\pi $ perioidic
	\item $ \int_{-\pi}^\pi D_N(\theta)\mathrm d\theta=2\pi $
\end{enumerate}
Property $ (ii) $ follows by intergrating $ \sum $ termwise, only $ 1 $ is non-zero. This means that
\[
	f(0)=\frac 1{2\pi}\int_{-\pi}^\pi D_N(\theta)f(\theta)\mathrm d\theta
\]
So
\[
	S_N(f)(0)=f(0)=\frac 1{2\pi}\int_{-\pi}^\pi D_N(\theta)[f(\theta)-f(0)]\mathrm d\theta
\]
now set $ F(\theta)=\frac{\theta}{\sin(\frac \theta 2)}\left[\frac{f(\theta)-f(0)}\theta\right] $
	so we get 
	\[
		(S_Nf)(0)=\frac 1{2\pi}\int_{-\pi}^\pi \sin[(N+\frac 12)\theta]F(\theta)\mathrm d\theta
	\]
	Note that $ \theta\to F(\theta) $ is smooth since
	\[
		\frac{f(\theta)-f(0)}{\theta}=\frac 1\theta\int_0^\theta f'(t)\mathrm dt=\frac 1\theta \int_0^1 f'(\tau\theta)\theta\mathrm d\tau
	\]
	Hence integrating by parts gives that
\begin{align*}
	(S_Nf)(0)-f(0)&=\frac{1}{N+\frac 12}\frac{1}{2\pi}\int_{-\pi}^\pi \cos[(N+\frac 12)\theta]F'(\theta)\mathrm d\theta \\
	&\to 0 \text{ as } N\to \infty
\end{align*}
For an example consider the function
\[
  f(\theta)=\begin{cases}
	  +1 & 0\le \theta < \pi \\
	  -1 & -\pi \le \theta < 0
  \end{cases}
\]
Since $ f $ is odd, $ a_n=0 $ for each $ n $ and
\begin{align*}
	b_n&=\frac{2}{2\pi}\int_{-\pi}^\pi f(\theta)\sin(n\theta)\mathrm d\theta \\
	   &= \frac 2\pi \int_0^\pi \sin(n\theta)\mathrm d\theta\\
	   &= \frac 2{n\pi}[1-(-1)^n]
\end{align*}
Thus
\[
	f(\theta)\sim \frac 4\pi \sum_{n \text{ odd}} \frac{\sin(n\theta)}n
\]
\subsection{Peridoic extensions: Cosine and sine series}
Given a function $ f:[0,L)\to \C $ we can define $ 2L $-periodic even/odd extensions called $ f_{even},f_{odd} $. Define,
\[
	f_{even}(\theta)=\begin{cases}
		f(\theta) & \theta\in[0,L)\\
		f(-\theta) & \theta\in[-L,0)\\
	\end{cases}
\]
and\[ 
f_{odd}(\theta)=\begin{cases}
		f(\theta) & \theta\in[0,L)\\
		-f(-\theta) & \theta\in[-L,0)\\
	\end{cases}
\].
Note that $ f(\theta)=f_{even}(\theta)=f_{odd}(\theta) $ if $ \theta\in [0,L) $.
\begin{align*}
	f_{even}(\theta)&\sim \frac 12 A_0+\sum_{n=1}^\infty A_n\cos\left(\frac{2\pi n \theta}{2L}\right)
	\\
	A_n&=\frac2{2L}\int_{-L}^Lf_{even}(\theta)cos\left(\frac{2\pi n\theta}{2L}\right)\mathrm d\theta\\
	   &= \frac 2L\int_0^Lf(\theta)cos\left(\frac{2\pi\theta}L\right)\mathrm d\theta
\end{align*}
simiarly we have that 
\begin{align*}
	f_{odd}(\theta)&\sim\sum_{n=1}^\infty B_n\sin\left(\frac{2\pi n\theta}{2L}\right)\\
	B_n&=\frac 2L\int_0^Lf(\theta)\sin\left(\frac{n\pi\theta}L\right)\mathrm d\theta
\end{align*}
\begin{definition}
	For $ f: [0,L)\to \C $ define its \textit{cosine} and \textit{sine} series by
	\begin{align*}
		\frac{1}2 A_0+\sum_{n=1}^\infty A_n\cos\left(\frac{n\pi\theta}L\right),\quad \sum_{n=1}^\infty B_n\sin\left(\frac{n\pi\theta}L\right)
	\end{align*}
	where $ A_n $ and $ B_n $ defined as before.
\end{definition}
For an example consider $ f(\theta)=1 $ on $ [0,\pi) $. For the sine series,
\begin{align*}
	B_n=\frac 2\pi \int_0^\pi \sin(n\theta)\mathrm d\theta=\frac2{n\pi}(1-(-1)^n)
\end{align*}
On the interval $ (0,\pi) $ we get that $ 1=f(\theta)=f_{odd}(\theta)=4\sum_{n\in \N}\frac{\sin(n\theta)}{n\pi} $. Whereas for the cosine series we get that 
\[
A_0=2,\quad A_n=0\quad n\ge 1
\]
So for $ \theta\in[0,\pi) $ we get that $ f_{even}=\frac 12\cdot 2 =1 =f(\theta) $.
\subsection{Regularity and decay of Fourier coefficients}
A true but non-examinable fact is that if $ g:[a,b]\to \C $ is integrable on $ [a,b] $ and $ \lambda\in \R $ then 
\[
	\int_a^be^{-i\lambda\theta}g(\theta)\mathrm d\theta\to 0 \text{ as } |\lambda|\to \infty. 
\]
IF $ f:\R\to \C $ is a $ L $-periodic function and integrable on $ [0,L) $ then
\begin{align*}
	\hat f = \frac 1L\int_0^Le^{-2\pi i n \theta/L}f(\theta)\mathrm d{\theta}
\end{align*}
so taking $ \lambda=\frac{2\pi n}L $ gives that $ \hat f_n\to 0 $ as $ n\to \infty $ by the Riemann-Lebesgue lemma. Also\[
a_n=\hat f_n+\hat f_{-n} \quad b_n=i(\hat f_n -\hat f_{-n}),\] 
both go to zero as $ n\to \infty $.\par
Suppose that $ f $ is $ L $-periodic and $ f\in C^k(\R) $.
\begin{align*}
	\hat f_n&=\frac 1L\int_0^Le^{-2\pi in\theta/L}f(\theta)\mathrm d\theta\\
		&=-\frac 1L\left(\frac{L}{2\pi in}\right)f(\theta)e^{-2\pi in\theta/L}\mathhuge|^L_{\theta=0}+\left(\frac{L}{2\pi in}\right)\frac 1L \int_0^Le^{-2\pi i n \theta/L}f'(\theta)\mathrm d\theta \\
		&= -\frac{L}{2\pi in}\left[\frac{f(L^-)-f(0^+)}L\right]+\frac{L}{2\pi in}\frac 1L\int_0^Le^{-2\pi in \theta}f'(\theta)\mathrm d\theta
\end{align*}
Since $ f $ is periodic and continuously differentiable we have that 
\[
  f(0^+)=f(L^+)=f(L^-)
\]
hence the boundary term cancels so repeating we get that 
\[
	\hat f_n=\left(\frac{L}{2\pi in}\right)^k\frac 1L\int_0^Le^{-2\pi in\theta/L}f^{(k)}(\theta)\mathrm d\theta
\]
and the integral is $ o(1) $ by the Rieman-Lebesgue lemma.\par
So we get that if $ f $ is $ C^k(\R) $ then $ \hat f_n = o\left(\frac 1{n^k}\right) $ as $ |n|\to \infty $.
\subsection{Termwise differentiation}
Suppose $ f $ is $ L $-periodic continuously differentiable on $ [0,L) $ with $ f'=g $ thne $ g $ is continuous on $ [0,L) $ so
\begin{align*}
	\hat g_n&=\frac 1L\int_0^Le^{-2\pi in\theta/L}f'(\theta)\mathrm d\theta\\
		&=\frac{f(L^-)-f(0^+)}L+\left(\frac{2\pi in}{L}\right)\frac 1L\int_0^Le^{-2\pi in\theta/L}f(\theta)\mathrm d\theta
\end{align*}
If $ f $ is continuous on $ \R $ then by periodicity we have that 
\begin{align*}
  f(0^+)=f(L^+)=f(L^-)
\end{align*}
so that 
\[
	\hat g_n=\left(\frac{2\pi in}L\right)\hat f_n
\]
i.e.
\[
	f'(\theta)=g(\theta)\sim \sum_n\left(\frac{2\pi in}L\right)\hat f_ne^{2\pi in\theta/L}
\]
\subsection{Parseval's theorem}
	If we have that \[f(\theta)\sim \sum_n\hat f_n e_n(\theta) \]
	and
	\[
	  g(\theta)\sim \sum_n\hat g_n e_n(\theta)
	\]
	then taking the inner product of both function we get that
	\begin{align*}
		\langle f,g\rangle &= \sum_{n,m}\hat f_n\overline{\hat g_n}\langle e_n,e_m\rangle\\
				   &= L\sum_n\hat f_n \overline{\hat g_n}
	\end{align*}
	finally that
	\begin{align*}
		\frac 1L\int_0^L f(\theta)\overline{g(\theta)}\mathrm d\theta=\sum_n \hat f_n \overline{\hat g_n}
	\end{align*}
	 and when $ f $ and $ g $ are the same we get that
	 \[
	   \frac 1L\int_0^L|f(\theta)|^2\mathrm d\theta=\sum_n|\hat f_n|^2
	 \]
\end{document}






